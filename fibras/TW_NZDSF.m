%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Entradas:
% bombeio =                         sinal =           
%    N_Bombeios: int(m)                     lambda: [1xn] 
%        lambda: [1xm]                           P: [1xn]
%             P: [1xm]                    N_Sinais: int(n)
%           Bwp: double                        Bws: double
%           FPL: double                        
%Saída:
% fibra =
%           L: double
%       alfas: [1xn]
%       alfap: [1xm]
%   alfasdBkm: [1xn]
%   alfapdBkm: [1xm]
% Crpicosinal: [1xn]
%  Crpicopump: [1xm]
%    Crnormal: [1xK]
%     sepfreq: [1xK]
%       Aeffs: [1xn]
%       Aeffp: [1xm]       
%          KR: double % Constante que depende do material dopante da fibra
%          NA: double % Abertura numérica da fibra
%          no: double % Índice de Refração do núcleo da fibra
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function fibra = TW_NZDSF(bombeio, sinal)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               Atenuação                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% sepfreq = 1440:20:1660;
% 
% TrueWave_NZDSF = [0.280 0.252 0.232 0.219 0.206 0.198 0.193 ...
%     0.190 0.192 0.199 0.219 0.246];
% 
% polyTrueWave_NZDSF = polyfit(sepfreq,TrueWave_NZDSF,4);

polyTrueWave_NZDSF = [1.764186334862795e-10,-1.082723266544934e-06,0.002495083497767,-2.559159328209145,9.860905308122664e+02];

fibra.alfasdBkm = polyval(polyTrueWave_NZDSF, sinal.lambda);
fibra.alfapdBkm = polyval(polyTrueWave_NZDSF, bombeio.lambda);

fibra.alfas = fibra.alfasdBkm*log(10)*1e-4;   %(neper/m)
fibra.alfap = fibra.alfapdBkm*log(10)*1e-4;   %(neper/m)

% fibra.alfap = 0.25*log(10)*1e-4*ones(1,bombeio.N_Bombeios);
% fibra.alfas = 0.23*log(10)*1e-4*ones(1,sinal.N_Sinais);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                   Calculo do ganho de Raman                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% lambdap_ref    = 1420;
% Crpico_refp    = 0.4277;  %(W^-1*km^-1) Coeficiente de Raman de pico 
% Crpico_up_refp = Crpico_refp*1e-3;  % (1/Wm) unidade padrao
% fibra.Crpicopump     = lambdap_ref*Crpico_up_refp./bombeio.lambda; % Corrige desnível no pico entre lambdas
% %
% lambdas_ref    = 1510;
% Crpico_refs    = 0.3451;  %(W^-1*km^-1) Coeficiente de Raman de pico 
% Crpico_up_refs = Crpico_refs*1e-3;  % (1/Wm) unidade padrao
% fibra.Crpicosinal = lambdas_ref*Crpico_up_refs./sinal.lambda;
%

CRPICO_SMF = 0.71;
% fibra.Crpicopump     = lambda_ref*CRPICO_SMF*1e-3./bombeio.lambda;
% fibra.Crpicosinal    = lambda_ref*CRPICO_SMF*1e-3./sinal.lambda;

fibra.Crpicopump     = CRPICO_SMF*1e-3*ones(1,bombeio.N_Bombeios);
fibra.Crpicosinal    = CRPICO_SMF*1e-3*ones(1,sinal.N_Sinais);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%              Pontos da curva de ganho normalizada                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fibra.Crnormal = [  0.013661 0.029173 0.053156 0.053997 0.059327 0.067602 0.076999 0.091164 ...
                    0.096914 0.114025 0.115849 0.117391 0.138569 0.144460 0.148668 0.157083 ...
                    0.152875 0.162693 0.175316 0.175316 0.183731 0.186536 0.200561 0.197756 ...
                    0.204769 0.200561 0.197756 0.217391 0.225806 0.230014 0.235624 0.231417 ...
                    0.239832 0.230014 0.241234 0.246844 0.244039 0.239832 0.232819 0.256662 ...
                    0.248247 0.267882 0.253857 0.263675 0.259467 0.262272 0.262272 0.263675 ...
                    0.272090 0.267882 0.283310 0.259467 0.270687 0.262272 0.277700 0.263675 ...
                    0.284712 0.284712 0.265077 0.276297 0.267882 0.276297 0.294530 0.273492 ...
                    0.265077 0.290323 0.287518 0.290323 0.274895 0.277700 0.277700 0.290323 ...
                    0.274895 0.280505 0.288920 0.283310 0.291725 0.297335 0.294530 0.301543 ...
                    0.294530 0.284712 0.297335 0.288920 0.311360 0.300140 0.300140 0.308555 ...
                    0.295933 0.312763 0.301543 0.302945 0.305750 0.305750 0.312763 0.304348 ...
                    0.315568 0.311360 0.316971 0.325386 0.316971 0.312763 0.330996 0.326788 ...
                    0.323983 0.333801 0.322581 0.333801 0.325386 0.339411 0.338008 0.345021 ...
                    0.346424 0.349229 0.350631 0.343619 0.350631 0.353436 0.352034 0.366059 ...
                    0.363254 0.366059 0.363254 0.373072 0.377279 0.378682 0.382889 0.385694 ...
                    0.385694 0.391304 0.395512 0.402525 0.392707 0.402525 0.395512 0.401122 ...
                    0.409537 0.412342 0.416550 0.417952 0.417952 0.429173 0.427770 0.433380 ...
                    0.436185 0.440393 0.438990 0.441795 0.450210 0.454418 0.450210 0.451613 ...
                    0.458626 0.462833 0.468443 0.474053 0.475456 0.479663 0.489481 0.485273 ...
                    0.489481 0.500701 0.499299 0.507714 0.506311 0.514727 0.516129 0.520337 ...
                    0.521739 0.525947 0.532959 0.539972 0.545582 0.546985 0.551192 0.556802 ...
                    0.559607 0.561010 0.565217 0.575035 0.579243 0.580645 0.583450 0.594670 ...
                    0.591865 0.600281 0.600281 0.611501 0.617111 0.622721 0.622721 0.632539 ...
                    0.636746 0.633941 0.649369 0.650771 0.659187 0.660589 0.664797 0.671809 ...
                    0.676017 0.684432 0.694250 0.698457 0.702665 0.711080 0.709677 0.722300 ...
                    0.726508 0.736325 0.736325 0.747546 0.751753 0.757363 0.764376 0.772791 ...
                    0.779804 0.782609 0.789621 0.795231 0.798036 0.803647 0.810659 0.816269 ...
                    0.816269 0.821879 0.826087 0.834502 0.840112 0.842917 0.849930 0.852735 ...
                    0.854137 0.861150 0.863955 0.872370 0.872370 0.880785 0.883590 0.886396 ...
                    0.892006 0.897616 0.894811 0.906031 0.906031 0.914446 0.914446 0.917251 ...
                    0.925666 0.924264 0.931276 0.931276 0.938289 0.943899 0.943899 0.952314 ...
                    0.949509 0.953717 0.959327 0.964937 0.967742 0.970547 0.977560 0.974755 ...
                    0.980365 0.984572 0.987377 0.984572 0.987377 0.991585 0.991585 0.994390 ...
                    1.000000 1.000000 0.994390 0.997195 0.994390 0.994390 0.991585 0.988780 ...
                    0.987377 0.985975 0.981767 0.976157 0.978962 0.973352 0.967742 0.969144 ...
                    0.960729 0.955119 0.956522 0.948107 0.948107 0.942496 0.936886 0.936886 ...
                    0.934081 0.935484 0.929874 0.932679 0.931276 0.929874 0.935484 0.939691 ...
                    0.941094 0.945302 0.939691 0.949509 0.942496 0.949509 0.943899 0.938289 ...
                    0.929874 0.925666 0.917251 0.906031 0.890603 0.872370 0.855540 0.837307 ...
                    0.820477 0.798036 0.775596 0.757363 0.732118 0.708275 0.681627 0.661992 ...
                    0.640954 0.617111 0.593268 0.572230 0.552595 0.535764 0.509116 0.497896 ...
                    0.478261 0.464236 0.451613 0.437588 0.427770 0.416550 0.401122 0.396914 ...
                    0.387097 0.381487 0.374474 0.361851 0.356241 0.349229 0.345021 0.339411 ...
                    0.333801 0.326788 0.323983 0.315568 0.312763 0.309958 0.307153 0.298738 ...
                    0.300140 0.291725 0.291725 0.290323 0.287518 0.286115 0.286115 0.281907 ...
                    0.279102 0.277700 0.279102 0.280505 0.279102 0.281907 0.277700 0.280505 ...
                    0.281907 0.279102 0.288920 0.291725 0.286115 0.288920 0.288920 0.291725 ...
                    0.295933 0.295933 0.298738 0.300140 0.302945 0.307153 0.308555 0.315568 ...
                    0.316971 0.321178 0.322581 0.332398 0.328191 0.333801 0.329593 0.333801 ...
                    0.333801 0.329593 0.328191 0.321178 0.316971 0.315568 0.301543 0.290323 ...
                    0.284712 0.273492 0.266480 0.256662 0.249649 0.241234 0.239832 0.228612 ...
                    0.223001 0.215989 0.204769 0.201964 0.200561 0.194951 0.180926 0.185133 ...
                    0.180926 0.171108 0.168303 0.162693 0.161290 0.147265 0.150070 0.151473 ...
                    0.135905 0.139130 0.134081 0.132258 0.138008 0.129734 0.129313 0.128892 ...
                    0.127349 0.125526 0.123703 0.125105 0.121038 0.122020 0.117952 0.119495 ...
                    0.122160 0.120898 0.114446 0.114025 0.118233 0.115428 0.111501 0.110519 ...
                    0.104909 0.106732 0.106592 0.102244 0.100701 0.100140 0.103927 0.100842 ...
                    0.095512 0.093408 0.099018 0.094530 0.094390 0.096353 0.096914 0.097335 ...
                    0.101403 0.101823 0.104348 0.111220 0.114586 0.120196 0.126788 0.136045 ...
                    0.143058 0.144460 0.154278 0.152875 0.159888 0.166900 0.169705 0.169705 ...
                    0.171108 0.165498 0.172511 0.172511 0.171108 0.169705 0.165498 0.140252 ...
                    0.126227 0.112202 0.098177 0.084151 0.070126 0.067321 0.064516 0.061711 ...
                    0.058906 0.057504 0.056101 0.054698 0.053296 0.051893 0.050491 0.047686 ...
                    0.044881 0.042076 0.039271 0.036466 0.033661 0.033661 0.036466 0.040673 ...
                    0.049088 0.058906 0.067321 0.067321 0.058906 0.049088 0.039271 0.033661 ...
                    0.030856 0.030856 0.032258 0.036466 0.040673 0.039271 0.035063 0.029453 ...
                    0.023843 0.018233 0.012623 0.007013 0.002805 0.000701 0.000140 0.000000];
        
fibra.sepfreq  = [5.296733E+011 6.176876E+011 7.495677E+011 7.928577E+011 8.373937E+011 8.812786E+011 9.689920E+011 ...
            1.012821E+012 1.056630E+012 1.144194E+012 1.187948E+012 1.231683E+012 1.319097E+012 1.362776E+012 ...
            1.406436E+012 1.493701E+012 1.537306E+012 1.580892E+012 1.668008E+012 1.711539E+012 1.755050E+012 ...
            1.842018E+012 1.885475E+012 1.928913E+012 2.015733E+012 2.059115E+012 2.102479E+012 2.189151E+012 ...
            2.275750E+012 2.362276E+012 2.405511E+012 2.448727E+012 2.535106E+012 2.578268E+012 2.621411E+012 ...
            2.707643E+012 2.750732E+012 2.793802E+012 2.879888E+012 2.922904E+012 2.965902E+012 3.051842E+012 ...
            3.094785E+012 3.137710E+012 3.223505E+012 3.266375E+012 3.309227E+012 3.394877E+012 3.437675E+012 ...
            3.480455E+012 3.565960E+012 3.608686E+012 3.651394E+012 3.736755E+012 3.779409E+012 3.822044E+012 ...
            3.907262E+012 3.949843E+012 3.992407E+012 4.077481E+012 4.119991E+012 4.162483E+012 4.247414E+012 ...
            4.289853E+012 4.332273E+012 4.374676E+012 4.417061E+012 4.459429E+012 4.501778E+012 4.544110E+012 ...
            4.586424E+012 4.628720E+012 4.670998E+012 4.713259E+012 4.755502E+012 4.797727E+012 4.839935E+012 ...
            4.882124E+012 4.924296E+012 4.966451E+012 5.008587E+012 5.050707E+012 5.092808E+012 5.134892E+012 ...
            5.176958E+012 5.219007E+012 5.261037E+012 5.303051E+012 5.345047E+012 5.387025E+012 5.428986E+012 ...
            5.470929E+012 5.512854E+012 5.554762E+012 5.596653E+012 5.638526E+012 5.680381E+012 5.722220E+012 ...
            5.764040E+012 5.805843E+012 5.847629E+012 5.889397E+012 5.931148E+012 5.972881E+012 6.014598E+012 ...
            6.056296E+012 6.097977E+012 6.139641E+012 6.181288E+012 6.222917E+012 6.264529E+012 6.306123E+012 ...
            6.347700E+012 6.389260E+012 6.430803E+012 6.472328E+012 6.513836E+012 6.555327E+012 6.596801E+012 ...
            6.638257E+012 6.679696E+012 6.721118E+012 6.762522E+012 6.803910E+012 6.845280E+012 6.886633E+012 ...
            6.927969E+012 6.969288E+012 7.010589E+012 7.051874E+012 7.093141E+012 7.134391E+012 7.175624E+012 ...
            7.216840E+012 7.258039E+012 7.299221E+012 7.340386E+012 7.381534E+012 7.422664E+012 7.463778E+012 ...
            7.504875E+012 7.545954E+012 7.587017E+012 7.628063E+012 7.669092E+012 7.710103E+012 7.751098E+012 ...
            7.792076E+012 7.833037E+012 7.873981E+012 7.914908E+012 7.955818E+012 7.996711E+012 8.037588E+012 ...
            8.078447E+012 8.119290E+012 8.160116E+012 8.200925E+012 8.241717E+012 8.282492E+012 8.323251E+012 ...
            8.363993E+012 8.404718E+012 8.445426E+012 8.486117E+012 8.526792E+012 8.567450E+012 8.608091E+012 ...
            8.648715E+012 8.689323E+012 8.770489E+012 8.811046E+012 8.851587E+012 8.892111E+012 8.932619E+012 ...
            8.973110E+012 9.013585E+012 9.054042E+012 9.094484E+012 9.134908E+012 9.215707E+012 9.256082E+012 ...
            9.296440E+012 9.336782E+012 9.377107E+012 9.417416E+012 9.457708E+012 9.538243E+012 9.578485E+012 ...
            9.618712E+012 9.658921E+012 9.699114E+012 9.739291E+012 9.779452E+012 9.859723E+012 9.899834E+012 ...
            9.939929E+012 9.980007E+012 1.002007E+013 1.006011E+013 1.010014E+013 1.018015E+013 1.022013E+013 ...
            1.026010E+013 1.030004E+013 1.033998E+013 1.037989E+013 1.041979E+013 1.049954E+013 1.053939E+013 ...
            1.057922E+013 1.061904E+013 1.065884E+013 1.069862E+013 1.073839E+013 1.081788E+013 1.085760E+013 ...
            1.089731E+013 1.093699E+013 1.097667E+013 1.101632E+013 1.105596E+013 1.109559E+013 1.113519E+013 ...
            1.117478E+013 1.121436E+013 1.125392E+013 1.129346E+013 1.133299E+013 1.137250E+013 1.141199E+013 ...
            1.145147E+013 1.149094E+013 1.153038E+013 1.156981E+013 1.160923E+013 1.164863E+013 1.168801E+013 ...
            1.172738E+013 1.176673E+013 1.180606E+013 1.184538E+013 1.188469E+013 1.192397E+013 1.196324E+013 ...
            1.200250E+013 1.204174E+013 1.208096E+013 1.212017E+013 1.215936E+013 1.219854E+013 1.223770E+013 ...
            1.227685E+013 1.231597E+013 1.235509E+013 1.239418E+013 1.243327E+013 1.247233E+013 1.251138E+013 ...
            1.255042E+013 1.258943E+013 1.262844E+013 1.266742E+013 1.270640E+013 1.274535E+013 1.278429E+013 ...
            1.282322E+013 1.286212E+013 1.290102E+013 1.293989E+013 1.297876E+013 1.301760E+013 1.305643E+013 ...
            1.309525E+013 1.313405E+013 1.317283E+013 1.321160E+013 1.325035E+013 1.328909E+013 1.332781E+013 ...
            1.336651E+013 1.340520E+013 1.344388E+013 1.348254E+013 1.352118E+013 1.355981E+013 1.359842E+013 ...
            1.363702E+013 1.367560E+013 1.371416E+013 1.375271E+013 1.379125E+013 1.382977E+013 1.386827E+013 ...
            1.390676E+013 1.394524E+013 1.398369E+013 1.402214E+013 1.406056E+013 1.409898E+013 1.413737E+013 ...
            1.417575E+013 1.421412E+013 1.425247E+013 1.429080E+013 1.432912E+013 1.436743E+013 1.440572E+013 ...
            1.444399E+013 1.448225E+013 1.452049E+013 1.455872E+013 1.459693E+013 1.463513E+013 1.467331E+013 ...
            1.471148E+013 1.474963E+013 1.478777E+013 1.482589E+013 1.486400E+013 1.490209E+013 1.494016E+013 ...
            1.497823E+013 1.501627E+013 1.505430E+013 1.509232E+013 1.513032E+013 1.516830E+013 1.520627E+013 ...
            1.524423E+013 1.528217E+013 1.532009E+013 1.535800E+013 1.539589E+013 1.543377E+013 1.547164E+013 ...
            1.550949E+013 1.554732E+013 1.558514E+013 1.562295E+013 1.566073E+013 1.569851E+013 1.573627E+013 ...
            1.577401E+013 1.581174E+013 1.584946E+013 1.588716E+013 1.592484E+013 1.596251E+013 1.600016E+013 ...
            1.603780E+013 1.607543E+013 1.611304E+013 1.615063E+013 1.618821E+013 1.622578E+013 1.630086E+013 ...
            1.633839E+013 1.637589E+013 1.641338E+013 1.645086E+013 1.648832E+013 1.652577E+013 1.656320E+013 ...
            1.660061E+013 1.663802E+013 1.667540E+013 1.671278E+013 1.675014E+013 1.678748E+013 1.682481E+013 ...
            1.686212E+013 1.689942E+013 1.693670E+013 1.697397E+013 1.701123E+013 1.704847E+013 1.708569E+013 ...
            1.712291E+013 1.716010E+013 1.719728E+013 1.723445E+013 1.727160E+013 1.730874E+013 1.734586E+013 ...
            1.738297E+013 1.742007E+013 1.745715E+013 1.749421E+013 1.753126E+013 1.756830E+013 1.760532E+013 ...
            1.764232E+013 1.767932E+013 1.771629E+013 1.775326E+013 1.779021E+013 1.782714E+013 1.786406E+013 ...
            1.790096E+013 1.793785E+013 1.797473E+013 1.801159E+013 1.804844E+013 1.808527E+013 1.812209E+013 ...
            1.815889E+013 1.823246E+013 1.826922E+013 1.830597E+013 1.834270E+013 1.837942E+013 1.841612E+013 ...
            1.845281E+013 1.848948E+013 1.852614E+013 1.856279E+013 1.859942E+013 1.863604E+013 1.867264E+013 ...
            1.870923E+013 1.874580E+013 1.881891E+013 1.885544E+013 1.889196E+013 1.896495E+013 1.903788E+013 ...
            1.911076E+013 1.914718E+013 1.925635E+013 1.929271E+013 1.936539E+013 1.939590E+013 1.958309E+013 ...
            1.961932E+013 1.972794E+013 1.976412E+013 1.983643E+013 1.994480E+013 1.998089E+013 2.001697E+013 ...
            2.012512E+013 2.016115E+013 2.023315E+013 2.034106E+013 2.037700E+013 2.041292E+013 2.052062E+013 ...
            2.059234E+013 2.062819E+013 2.073563E+013 2.077142E+013 2.080719E+013 2.091443E+013 2.095015E+013 ...
            2.109288E+013 2.116417E+013 2.130658E+013 2.137770E+013 2.144876E+013 2.155526E+013 2.166163E+013 ...
            2.169706E+013 2.183865E+013 2.190936E+013 2.201533E+013 2.212117E+013 2.215643E+013 2.233250E+013 ...
            2.247311E+013 2.250823E+013 2.254333E+013 2.264857E+013 2.271866E+013 2.282370E+013 2.292862E+013 ...
            2.299849E+013 2.306832E+013 2.310321E+013 2.320781E+013 2.324265E+013 2.327747E+013 2.338187E+013 ...
            2.341664E+013 2.348615E+013 2.359031E+013 2.372900E+013 2.376364E+013 2.379827E+013 2.386749E+013 ...
            2.393665E+013 2.400576E+013 2.407482E+013 2.414382E+013 2.421278E+013 2.435053E+013 2.446058E+013 ...
            2.457049E+013 2.468028E+013 2.478993E+013 2.489945E+013 2.500883E+013 2.511809E+013 2.522721E+013 ...
            2.533620E+013 2.544506E+013 2.566239E+013 2.587919E+013 2.609547E+013 2.631124E+013 2.652648E+013 ...
            2.706235E+013 2.759503E+013 2.812455E+013 2.865094E+013 2.917422E+013 2.969442E+013 3.021157E+013 ...
            3.062311E+013 3.103273E+013 3.144045E+013 3.184626E+013 3.225020E+013 3.265226E+013 3.305247E+013 ...
            3.345084E+013 3.384737E+013 3.424209E+013 3.473295E+013 3.522101E+013 3.570630E+013 3.618884E+013 ...
            3.666866E+013 3.714577E+013 3.762020E+013 3.809197E+013 3.856111E+013 3.902763E+013 3.949156E+013 ...
            3.995292E+013 4.041173E+013 4.086802E+013 4.132180E+013 4.177309E+013];
                
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                             Área Efetiva                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
lamb  = 1400:1649; 
Aeff_lambda_ref = 55;  %Livro Mohammed Islam, pg 115
Aeff_ref = [0.86858 0.86937 0.87015 0.87094 0.87172 0.87251 0.87330 ...
            0.87408 0.87487 0.87566 0.87644 0.87723 0.87801 0.87880 ...
            0.87972 0.88050 0.88129 0.88208 0.88286 0.88365 0.88443 ...
            0.88535 0.88614 0.88692 0.88771 0.88850 0.88941 0.89020 ...
            0.89099 0.89177 0.89269 0.89347 0.89426 0.89518 0.89596 ...
            0.89675 0.89754 0.89845 0.89924 0.90003 0.90094 0.90173 ...
            0.90252 0.90343 0.90422 0.90514 0.90592 0.90671 0.90763 ...
            0.90841 0.90933 0.91012 0.91103 0.91182 0.91274 0.91352 ...
            0.91444 0.91523 0.91614 0.91693 0.91785 0.91863 0.91955 ...
            0.92034 0.92125 0.92204 0.92296 0.92387 0.92466 0.92558 ...
            0.92636 0.92728 0.92820 0.92898 0.92990 0.93082 0.93160 ...
            0.93252 0.93344 0.93436 0.93514 0.93606 0.93698 0.93776 ...
            0.93868 0.93960 0.94051 0.94143 0.94222 0.94313 0.94405 ...
            0.94497 0.94589 0.94667 0.94759 0.94851 0.94942 0.95034 ...
            0.95126 0.95218 0.95309 0.95401 0.95493 0.95571 0.95663 ...
            0.95755 0.95846 0.95938 0.96030 0.96122 0.96213 0.96305 ...
            0.96397 0.96488 0.96580 0.96685 0.96777 0.96868 0.96960 ...
            0.97052 0.97144 0.97235 0.97327 0.97419 0.97524 0.97615 ...
            0.97707 0.97799 0.97890 0.97995 0.98087 0.98179 0.98270 ...
            0.98375 0.98467 0.98559 0.98650 0.98755 0.98847 0.98939 ...
            0.99044 0.99135 0.99227 0.99332 0.99423 0.99515 0.99620 ...
            0.99712 0.99817 0.99908 1.00000 1.00105 1.00197 1.00301 ...
            1.00393 1.00498 1.00590 1.00694 1.00786 1.00891 1.00983 ...
            1.01088 1.01192 1.01284 1.01389 1.01481 1.01585 1.01690 ...
            1.01782 1.01887 1.01979 1.02083 1.02188 1.02280 1.02385 ...
            1.02490 1.02594 1.02686 1.02791 1.02896 1.03001 1.03092 ...
            1.03197 1.03302 1.03407 1.03512 1.03616 1.03708 1.03813 ...
            1.03918 1.04023 1.04127 1.04232 1.04337 1.04442 1.04547 ...
            1.04651 1.04756 1.04861 1.04966 1.05071 1.05176 1.05280 ...
            1.05385 1.05490 1.05595 1.05700 1.05805 1.05909 1.06014 ...
            1.06119 1.06224 1.06342 1.06447 1.06551 1.06656 1.06761 ...
            1.06879 1.06984 1.07089 1.07193 1.07311 1.07416 1.07521 ...
            1.07626 1.07744 1.07849 1.07953 1.08071 1.08176 1.08281 ...
            1.08399 1.08504 1.08622 1.08726 1.08844 1.08949 1.09054 ...
            1.09172 1.09277 1.09395 1.09499 1.09617 1.09735 1.09840 ...
            1.09958 1.10063 1.10181 1.10286 1.10404];
 
poly_Aeff = polyfit(lamb, Aeff_ref*Aeff_lambda_ref, 2);  
    
fibra.Aeffs = 1e-12*polyval(poly_Aeff, sinal.lambda);
fibra.Aeffp = 1e-12*polyval(poly_Aeff, bombeio.lambda);
                
                
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%   Características da fibra para o cálculo do coeficiente de Rayleigh  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
fibra.KR = 60;   % (dB/km) constante que depende do material dopante da fibra (Assumido)
fibra.NA = 0.14; % abertura numerica da fibra (Assumido)
fibra.no = 1.468;  %NA^2/(2*deltaindice);  % indice de refracao do nucleo da fibra (Assumido)              
